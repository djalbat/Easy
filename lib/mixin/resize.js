'use strict';

function constructor(element) {
  element.resizeHandlers = [];
}

function onResize(resizeHandler) {
  var resizeHandlers = hasResizeHandlers(this);

  if (!resizeHandlers) {
    appendResizeObject(this);
  }

  addResizeHandler(this, resizeHandler);
}

function offResize(resizeHandler) {
  removeResizeHandler(this, resizeHandler);

  var resizeHandlers = hasResizeHandlers(this);

  if (!resizeHandlers) {
    removeResizeObject(this);
  }
}

var resize = {
  constructor: constructor,
  onResize: onResize,
  offResize: offResize
};

module.exports = resize;

function hasResizeHandlers(element) {
  var resizeHandlersLength = element.resizeHandlers.length,
      resizeHandlers = resizeHandlersLength > 0;

  return resizeHandlers;
}

function addResizeHandler(element, resizeHandler) {
  element.resizeHandlers.push(resizeHandler);
}

function removeResizeHandler(element, resizeHandler) {
  var index = element.resizeHandlers.indexOf(resizeHandler);

  if (index > -1) {
    var deleteCount = 1;

    element.resizeHandlers.splice(index, deleteCount);
  }
}

function appendResizeObject(element) {
  var resizeObject = document.createElement('object'),
      domElement = element.domElement,
      style = ' display: block; \n                  position: absolute; \n                  top: 0; \n                  left: 0; \n                  height: 100%; \n                  width: 100%; \n                  overflow: hidden; \n                  pointer-events: none; \n                  z-index: -1;';

  resizeObject.setAttribute('style', style);
  resizeObject.data = 'about:blank';
  resizeObject.type = 'text/html';

  domElement.appendChild(resizeObject);

  element.__resizeObject__ = resizeObject;

  resizeObject.onload = function () {
    resizeObjectLoadHandler(element);
  };
}

function removeResizeObject(element) {
  var domElement = element.domElement,
      resizeObject = element.__resizeObject__,
      objectWindow = resizeObject.contentDocument.defaultView; ///

  objectWindow.removeEventListener('resize', resizeListener);

  domElement.removeChild(resizeObject);
}

function resizeObjectLoadHandler(element) {
  var width = element.getWidth(),
      height = element.getHeight();

  element.resizeHandlers.forEach(function (resizeHandler) {
    resizeHandler(width, height);
  });
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL2VzNi9taXhpbi9yZXNpemUuanMiXSwibmFtZXMiOlsiY29uc3RydWN0b3IiLCJlbGVtZW50IiwicmVzaXplSGFuZGxlcnMiLCJvblJlc2l6ZSIsInJlc2l6ZUhhbmRsZXIiLCJoYXNSZXNpemVIYW5kbGVycyIsImFwcGVuZFJlc2l6ZU9iamVjdCIsImFkZFJlc2l6ZUhhbmRsZXIiLCJvZmZSZXNpemUiLCJyZW1vdmVSZXNpemVIYW5kbGVyIiwicmVtb3ZlUmVzaXplT2JqZWN0IiwicmVzaXplIiwibW9kdWxlIiwiZXhwb3J0cyIsInJlc2l6ZUhhbmRsZXJzTGVuZ3RoIiwibGVuZ3RoIiwicHVzaCIsImluZGV4IiwiaW5kZXhPZiIsImRlbGV0ZUNvdW50Iiwic3BsaWNlIiwicmVzaXplT2JqZWN0IiwiZG9jdW1lbnQiLCJjcmVhdGVFbGVtZW50IiwiZG9tRWxlbWVudCIsInN0eWxlIiwic2V0QXR0cmlidXRlIiwiZGF0YSIsInR5cGUiLCJhcHBlbmRDaGlsZCIsIl9fcmVzaXplT2JqZWN0X18iLCJvbmxvYWQiLCJyZXNpemVPYmplY3RMb2FkSGFuZGxlciIsIm9iamVjdFdpbmRvdyIsImNvbnRlbnREb2N1bWVudCIsImRlZmF1bHRWaWV3IiwicmVtb3ZlRXZlbnRMaXN0ZW5lciIsInJlc2l6ZUxpc3RlbmVyIiwicmVtb3ZlQ2hpbGQiLCJ3aWR0aCIsImdldFdpZHRoIiwiaGVpZ2h0IiwiZ2V0SGVpZ2h0IiwiZm9yRWFjaCJdLCJtYXBwaW5ncyI6IkFBQUE7O0FBRUEsU0FBU0EsV0FBVCxDQUFxQkMsT0FBckIsRUFBOEI7QUFDNUJBLFVBQVFDLGNBQVIsR0FBeUIsRUFBekI7QUFDRDs7QUFFRCxTQUFTQyxRQUFULENBQWtCQyxhQUFsQixFQUFpQztBQUMvQixNQUFNRixpQkFBaUJHLGtCQUFrQixJQUFsQixDQUF2Qjs7QUFFQSxNQUFJLENBQUNILGNBQUwsRUFBcUI7QUFDbkJJLHVCQUFtQixJQUFuQjtBQUNEOztBQUVEQyxtQkFBaUIsSUFBakIsRUFBdUJILGFBQXZCO0FBQ0Q7O0FBRUQsU0FBU0ksU0FBVCxDQUFtQkosYUFBbkIsRUFBa0M7QUFDaENLLHNCQUFvQixJQUFwQixFQUEwQkwsYUFBMUI7O0FBRUEsTUFBTUYsaUJBQWlCRyxrQkFBa0IsSUFBbEIsQ0FBdkI7O0FBRUEsTUFBSSxDQUFDSCxjQUFMLEVBQXFCO0FBQ25CUSx1QkFBbUIsSUFBbkI7QUFDRDtBQUNGOztBQUVELElBQU1DLFNBQVM7QUFDYlgsZUFBYUEsV0FEQTtBQUViRyxZQUFVQSxRQUZHO0FBR2JLLGFBQVdBO0FBSEUsQ0FBZjs7QUFNQUksT0FBT0MsT0FBUCxHQUFpQkYsTUFBakI7O0FBRUEsU0FBU04saUJBQVQsQ0FBMkJKLE9BQTNCLEVBQW9DO0FBQ2xDLE1BQU1hLHVCQUF1QmIsUUFBUUMsY0FBUixDQUF1QmEsTUFBcEQ7QUFBQSxNQUNNYixpQkFBa0JZLHVCQUF1QixDQUQvQzs7QUFHQSxTQUFPWixjQUFQO0FBQ0Q7O0FBRUQsU0FBU0ssZ0JBQVQsQ0FBMEJOLE9BQTFCLEVBQW1DRyxhQUFuQyxFQUFrRDtBQUNoREgsVUFBUUMsY0FBUixDQUF1QmMsSUFBdkIsQ0FBNEJaLGFBQTVCO0FBQ0Q7O0FBRUQsU0FBU0ssbUJBQVQsQ0FBNkJSLE9BQTdCLEVBQXNDRyxhQUF0QyxFQUFxRDtBQUNuRCxNQUFNYSxRQUFRaEIsUUFBUUMsY0FBUixDQUF1QmdCLE9BQXZCLENBQStCZCxhQUEvQixDQUFkOztBQUVBLE1BQUlhLFFBQVEsQ0FBQyxDQUFiLEVBQWdCO0FBQ2QsUUFBTUUsY0FBYyxDQUFwQjs7QUFFQWxCLFlBQVFDLGNBQVIsQ0FBdUJrQixNQUF2QixDQUE4QkgsS0FBOUIsRUFBcUNFLFdBQXJDO0FBQ0Q7QUFDRjs7QUFFRCxTQUFTYixrQkFBVCxDQUE0QkwsT0FBNUIsRUFBcUM7QUFDbkMsTUFBTW9CLGVBQWVDLFNBQVNDLGFBQVQsQ0FBdUIsUUFBdkIsQ0FBckI7QUFBQSxNQUNNQyxhQUFhdkIsUUFBUXVCLFVBRDNCO0FBQUEsTUFFTUMsK1NBRk47O0FBWUFKLGVBQWFLLFlBQWIsQ0FBMEIsT0FBMUIsRUFBbUNELEtBQW5DO0FBQ0FKLGVBQWFNLElBQWIsR0FBb0IsYUFBcEI7QUFDQU4sZUFBYU8sSUFBYixHQUFvQixXQUFwQjs7QUFFQUosYUFBV0ssV0FBWCxDQUF1QlIsWUFBdkI7O0FBRUFwQixVQUFRNkIsZ0JBQVIsR0FBMkJULFlBQTNCOztBQUVBQSxlQUFhVSxNQUFiLEdBQXNCLFlBQVc7QUFDL0JDLDRCQUF3Qi9CLE9BQXhCO0FBQ0QsR0FGRDtBQUdEOztBQUVELFNBQVNTLGtCQUFULENBQTRCVCxPQUE1QixFQUFxQztBQUNuQyxNQUFNdUIsYUFBYXZCLFFBQVF1QixVQUEzQjtBQUFBLE1BQ01ILGVBQWVwQixRQUFRNkIsZ0JBRDdCO0FBQUEsTUFFTUcsZUFBZVosYUFBYWEsZUFBYixDQUE2QkMsV0FGbEQsQ0FEbUMsQ0FHNkI7O0FBRWhFRixlQUFhRyxtQkFBYixDQUFpQyxRQUFqQyxFQUEyQ0MsY0FBM0M7O0FBRUFiLGFBQVdjLFdBQVgsQ0FBdUJqQixZQUF2QjtBQUNEOztBQUVELFNBQVNXLHVCQUFULENBQWlDL0IsT0FBakMsRUFBMEM7QUFDeEMsTUFBTXNDLFFBQVF0QyxRQUFRdUMsUUFBUixFQUFkO0FBQUEsTUFDTUMsU0FBU3hDLFFBQVF5QyxTQUFSLEVBRGY7O0FBR0F6QyxVQUFRQyxjQUFSLENBQXVCeUMsT0FBdkIsQ0FBK0IsVUFBU3ZDLGFBQVQsRUFBdUI7QUFDcERBLGtCQUFjbUMsS0FBZCxFQUFxQkUsTUFBckI7QUFDRCxHQUZEO0FBR0QiLCJmaWxlIjoicmVzaXplLmpzIiwic291cmNlc0NvbnRlbnQiOlsiJ3VzZSBzdHJpY3QnO1xuXG5mdW5jdGlvbiBjb25zdHJ1Y3RvcihlbGVtZW50KSB7XG4gIGVsZW1lbnQucmVzaXplSGFuZGxlcnMgPSBbXTtcbn1cblxuZnVuY3Rpb24gb25SZXNpemUocmVzaXplSGFuZGxlcikge1xuICBjb25zdCByZXNpemVIYW5kbGVycyA9IGhhc1Jlc2l6ZUhhbmRsZXJzKHRoaXMpO1xuXG4gIGlmICghcmVzaXplSGFuZGxlcnMpIHtcbiAgICBhcHBlbmRSZXNpemVPYmplY3QodGhpcyk7XG4gIH1cblxuICBhZGRSZXNpemVIYW5kbGVyKHRoaXMsIHJlc2l6ZUhhbmRsZXIpO1xufVxuXG5mdW5jdGlvbiBvZmZSZXNpemUocmVzaXplSGFuZGxlcikge1xuICByZW1vdmVSZXNpemVIYW5kbGVyKHRoaXMsIHJlc2l6ZUhhbmRsZXIpO1xuXG4gIGNvbnN0IHJlc2l6ZUhhbmRsZXJzID0gaGFzUmVzaXplSGFuZGxlcnModGhpcyk7XG5cbiAgaWYgKCFyZXNpemVIYW5kbGVycykge1xuICAgIHJlbW92ZVJlc2l6ZU9iamVjdCh0aGlzKTtcbiAgfVxufVxuXG5jb25zdCByZXNpemUgPSB7XG4gIGNvbnN0cnVjdG9yOiBjb25zdHJ1Y3RvcixcbiAgb25SZXNpemU6IG9uUmVzaXplLFxuICBvZmZSZXNpemU6IG9mZlJlc2l6ZVxufTtcblxubW9kdWxlLmV4cG9ydHMgPSByZXNpemU7XG5cbmZ1bmN0aW9uIGhhc1Jlc2l6ZUhhbmRsZXJzKGVsZW1lbnQpIHtcbiAgY29uc3QgcmVzaXplSGFuZGxlcnNMZW5ndGggPSBlbGVtZW50LnJlc2l6ZUhhbmRsZXJzLmxlbmd0aCxcbiAgICAgICAgcmVzaXplSGFuZGxlcnMgPSAocmVzaXplSGFuZGxlcnNMZW5ndGggPiAwKTtcblxuICByZXR1cm4gcmVzaXplSGFuZGxlcnM7XG59XG5cbmZ1bmN0aW9uIGFkZFJlc2l6ZUhhbmRsZXIoZWxlbWVudCwgcmVzaXplSGFuZGxlcikge1xuICBlbGVtZW50LnJlc2l6ZUhhbmRsZXJzLnB1c2gocmVzaXplSGFuZGxlcik7XG59XG5cbmZ1bmN0aW9uIHJlbW92ZVJlc2l6ZUhhbmRsZXIoZWxlbWVudCwgcmVzaXplSGFuZGxlcikge1xuICBjb25zdCBpbmRleCA9IGVsZW1lbnQucmVzaXplSGFuZGxlcnMuaW5kZXhPZihyZXNpemVIYW5kbGVyKTtcblxuICBpZiAoaW5kZXggPiAtMSkge1xuICAgIGNvbnN0IGRlbGV0ZUNvdW50ID0gMTtcblxuICAgIGVsZW1lbnQucmVzaXplSGFuZGxlcnMuc3BsaWNlKGluZGV4LCBkZWxldGVDb3VudCk7XG4gIH1cbn1cblxuZnVuY3Rpb24gYXBwZW5kUmVzaXplT2JqZWN0KGVsZW1lbnQpIHtcbiAgY29uc3QgcmVzaXplT2JqZWN0ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnb2JqZWN0JyksXG4gICAgICAgIGRvbUVsZW1lbnQgPSBlbGVtZW50LmRvbUVsZW1lbnQsXG4gICAgICAgIHN0eWxlID0gYCBkaXNwbGF5OiBibG9jazsgXG4gICAgICAgICAgICAgICAgICBwb3NpdGlvbjogYWJzb2x1dGU7IFxuICAgICAgICAgICAgICAgICAgdG9wOiAwOyBcbiAgICAgICAgICAgICAgICAgIGxlZnQ6IDA7IFxuICAgICAgICAgICAgICAgICAgaGVpZ2h0OiAxMDAlOyBcbiAgICAgICAgICAgICAgICAgIHdpZHRoOiAxMDAlOyBcbiAgICAgICAgICAgICAgICAgIG92ZXJmbG93OiBoaWRkZW47IFxuICAgICAgICAgICAgICAgICAgcG9pbnRlci1ldmVudHM6IG5vbmU7IFxuICAgICAgICAgICAgICAgICAgei1pbmRleDogLTE7YDtcblxuICByZXNpemVPYmplY3Quc2V0QXR0cmlidXRlKCdzdHlsZScsIHN0eWxlKTtcbiAgcmVzaXplT2JqZWN0LmRhdGEgPSAnYWJvdXQ6YmxhbmsnO1xuICByZXNpemVPYmplY3QudHlwZSA9ICd0ZXh0L2h0bWwnO1xuXG4gIGRvbUVsZW1lbnQuYXBwZW5kQ2hpbGQocmVzaXplT2JqZWN0KTtcblxuICBlbGVtZW50Ll9fcmVzaXplT2JqZWN0X18gPSByZXNpemVPYmplY3Q7XG5cbiAgcmVzaXplT2JqZWN0Lm9ubG9hZCA9IGZ1bmN0aW9uKCkge1xuICAgIHJlc2l6ZU9iamVjdExvYWRIYW5kbGVyKGVsZW1lbnQpXG4gIH07XG59XG5cbmZ1bmN0aW9uIHJlbW92ZVJlc2l6ZU9iamVjdChlbGVtZW50KSB7XG4gIGNvbnN0IGRvbUVsZW1lbnQgPSBlbGVtZW50LmRvbUVsZW1lbnQsXG4gICAgICAgIHJlc2l6ZU9iamVjdCA9IGVsZW1lbnQuX19yZXNpemVPYmplY3RfXyxcbiAgICAgICAgb2JqZWN0V2luZG93ID0gcmVzaXplT2JqZWN0LmNvbnRlbnREb2N1bWVudC5kZWZhdWx0VmlldzsgIC8vL1xuXG4gIG9iamVjdFdpbmRvdy5yZW1vdmVFdmVudExpc3RlbmVyKCdyZXNpemUnLCByZXNpemVMaXN0ZW5lcik7XG5cbiAgZG9tRWxlbWVudC5yZW1vdmVDaGlsZChyZXNpemVPYmplY3QpO1xufVxuXG5mdW5jdGlvbiByZXNpemVPYmplY3RMb2FkSGFuZGxlcihlbGVtZW50KSB7XG4gIGNvbnN0IHdpZHRoID0gZWxlbWVudC5nZXRXaWR0aCgpLFxuICAgICAgICBoZWlnaHQgPSBlbGVtZW50LmdldEhlaWdodCgpO1xuXG4gIGVsZW1lbnQucmVzaXplSGFuZGxlcnMuZm9yRWFjaChmdW5jdGlvbihyZXNpemVIYW5kbGVyKXtcbiAgICByZXNpemVIYW5kbGVyKHdpZHRoLCBoZWlnaHQpO1xuICB9KTtcbn1cbiJdfQ==