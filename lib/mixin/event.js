'use strict';

function on(eventTypes, handler) {
  eventTypes = eventTypes.split(' '); ///

  eventTypes.forEach(function (eventType) {
    onEvent(this, eventType, handler);
  }.bind(this));
}

function off(eventTypes, handler) {
  eventTypes = eventTypes.split(' '); ///

  eventTypes.forEach(function (eventType) {
    offEvent(this, eventType, handler);
  }.bind(this));
}

var eventMixin = {
  on: on,
  off: off
};

module.exports = eventMixin;

function onEvent(element, eventType, handler) {
  if (element.eventObjectMap === undefined) {
    element.eventObjectMap = {};
  }

  var eventObject = element.eventObjectMap[eventType];

  if (!eventObject) {
    eventObject = createEventObject();

    eventObject.addHandler(element, eventType, handler);

    element.eventObjectMap[eventType] = eventObject;
  }
}

function offEvent(element, eventType, handler) {
  var eventObject = element.eventObjectMap[eventType],
      noneRemaining = eventObject.removeHandler(eventType, handler);

  if (noneRemaining) {
    delete element.eventObjectMap[eventType];
  }

  var eventTypes = Object.keys(element.eventObjectMap);

  if (eventTypes.length === 0) {
    delete element.eventObjectMap;
  }
}

function createEventObject() {
  var eventListeners = [];

  function addHandler(element, eventType, handler) {
    var targetElement = element,
        ///
    eventListener = createEventListener(handler, targetElement);

    element.domElement.addEventListener(eventType, eventListener);

    eventListeners.push(eventListener);
  }

  function removeHandler(eventType) {
    var handler = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : null;

    if (handler === null) {
      eventListeners.forEach(function (eventListener) {
        element.domElement.removeEventListener(eventType, eventListener);
      });

      var start = 0;

      eventListeners.splice(start);
    } else {
      var index = indexOfEventListener(eventListeners, handler),
          eventListener = eventListeners[index];

      element.domElement.removeEventListener(eventType, eventListener);

      var _start = index,
          ///
      deleteCount = 1;

      eventListeners.splice(_start, deleteCount);
    }

    var noneRemaining = eventListeners.length === 0; ///

    return noneRemaining;
  }

  return {
    addHandler: addHandler,
    removeHandler: removeHandler
  };
}

function indexOfEventListener(eventListeners, handler) {
  var foundIndex = undefined; ///

  eventListeners.forEach(function (eventListener, index) {
    if (eventListener.handler === handler) {
      foundIndex = index;
    }
  });

  var index = foundIndex; ///

  return index;
}

function createEventListener(handler, targetElement) {
  var eventListener = function eventListener(event) {
    var handler = this.handler,
        preventDefault = handler.intermediateHandler !== undefined ? handler.intermediateHandler(handler, event, targetElement) : handler(event, targetElement);

    if (preventDefault === true) {
      event.preventDefault();
    }

    event.stopPropagation();
  };

  eventListener.handler = handler; ///

  return eventListener;
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL2VzNi9taXhpbi9ldmVudC5qcyJdLCJuYW1lcyI6WyJvbiIsImV2ZW50VHlwZXMiLCJoYW5kbGVyIiwic3BsaXQiLCJmb3JFYWNoIiwiZXZlbnRUeXBlIiwib25FdmVudCIsImJpbmQiLCJvZmYiLCJvZmZFdmVudCIsImV2ZW50TWl4aW4iLCJtb2R1bGUiLCJleHBvcnRzIiwiZWxlbWVudCIsImV2ZW50T2JqZWN0TWFwIiwidW5kZWZpbmVkIiwiZXZlbnRPYmplY3QiLCJjcmVhdGVFdmVudE9iamVjdCIsImFkZEhhbmRsZXIiLCJub25lUmVtYWluaW5nIiwicmVtb3ZlSGFuZGxlciIsIk9iamVjdCIsImtleXMiLCJsZW5ndGgiLCJldmVudExpc3RlbmVycyIsInRhcmdldEVsZW1lbnQiLCJldmVudExpc3RlbmVyIiwiY3JlYXRlRXZlbnRMaXN0ZW5lciIsImRvbUVsZW1lbnQiLCJhZGRFdmVudExpc3RlbmVyIiwicHVzaCIsInJlbW92ZUV2ZW50TGlzdGVuZXIiLCJzdGFydCIsInNwbGljZSIsImluZGV4IiwiaW5kZXhPZkV2ZW50TGlzdGVuZXIiLCJkZWxldGVDb3VudCIsImZvdW5kSW5kZXgiLCJldmVudCIsInByZXZlbnREZWZhdWx0IiwiaW50ZXJtZWRpYXRlSGFuZGxlciIsInN0b3BQcm9wYWdhdGlvbiJdLCJtYXBwaW5ncyI6IkFBQUE7O0FBRUEsU0FBU0EsRUFBVCxDQUFZQyxVQUFaLEVBQXdCQyxPQUF4QixFQUFpQztBQUMvQkQsZUFBYUEsV0FBV0UsS0FBWCxDQUFpQixHQUFqQixDQUFiLENBRCtCLENBQ0s7O0FBRXBDRixhQUFXRyxPQUFYLENBQW1CLFVBQVNDLFNBQVQsRUFBb0I7QUFDckNDLFlBQVEsSUFBUixFQUFjRCxTQUFkLEVBQXlCSCxPQUF6QjtBQUNELEdBRmtCLENBRWpCSyxJQUZpQixDQUVaLElBRlksQ0FBbkI7QUFHRDs7QUFFRCxTQUFTQyxHQUFULENBQWFQLFVBQWIsRUFBeUJDLE9BQXpCLEVBQWtDO0FBQ2hDRCxl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IHN0cmljdCc7XG5cbmZ1bmN0aW9uIG9uKGV2ZW50VHlwZXMsIGhhbmRsZXIpIHtcbiAgZXZlbnRUeXBlcyA9IGV2ZW50VHlwZXMuc3BsaXQoJyAnKTsgLy8vXG5cbiAgZXZlbnRUeXBlcy5mb3JFYWNoKGZ1bmN0aW9uKGV2ZW50VHlwZSkge1xuICAgIG9uRXZlbnQodGhpcywgZXZlbnRUeXBlLCBoYW5kbGVyKTtcbiAgfS5iaW5kKHRoaXMpKTtcbn1cblxuZnVuY3Rpb24gb2ZmKGV2ZW50VHlwZXMsIGhhbmRsZXIpIHtcbiAgZXZlbnRUeXBlcyA9IGV2ZW50VHlwZXMuc3BsaXQoJyAnKTsgLy8vXG5cbiAgZXZlbnRUeXBlcy5mb3JFYWNoKGZ1bmN0aW9uKGV2ZW50VHlwZSkge1xuICAgIG9mZkV2ZW50KHRoaXMsIGV2ZW50VHlwZSwgaGFuZGxlcik7XG4gIH0uYmluZCh0aGlzKSk7XG59XG5cbmNvbnN0IGV2ZW50TWl4aW4gPSB7XG4gIG9uOiBvbixcbiAgb2ZmOiBvZmZcbn07XG5cbm1vZHVsZS5leHBvcnRzID0gZXZlbnRNaXhpbjtcblxuZnVuY3Rpb24gb25FdmVudChlbGVtZW50LCBldmVudFR5cGUsIGhhbmRsZXIpIHtcbiAgaWYgKGVsZW1lbnQuZXZlbnRPYmplY3RNYXAgPT09IHVuZGVmaW5lZCkge1xuICAgIGVsZW1lbnQuZXZlbnRPYmplY3RNYXAgPSB7fTtcbiAgfVxuXG4gIGxldCBldmVudE9iamVjdCA9IGVsZW1lbnQuZXZlbnRPYmplY3RNYXBbZXZlbnRUeXBlXTtcblxuICBpZiAoIWV2ZW50T2JqZWN0KSB7XG4gICAgZXZlbnRPYmplY3QgPSBjcmVhdGVFdmVudE9iamVjdCgpO1xuXG4gICAgZXZlbnRPYmplY3QuYWRkSGFuZGxlcihlbGVtZW50LCBldmVudFR5cGUsIGhhbmRsZXIpO1xuXG4gICAgZWxlbWVudC5ldmVudE9iamVjdE1hcFtldmVudFR5cGVdID0gZXZlbnRPYmplY3Q7XG4gIH1cbn1cblxuZnVuY3Rpb24gb2ZmRXZlbnQoZWxlbWVudCwgZXZlbnRUeXBlLCBoYW5kbGVyKSB7XG4gIGNvbnN0IGV2ZW50T2JqZWN0ID0gZWxlbWVudC5ldmVudE9iamVjdE1hcFtldmVudFR5cGVdLFxuICAgICAgICBub25lUmVtYWluaW5nID0gZXZlbnRPYmplY3QucmVtb3ZlSGFuZGxlcihldmVudFR5cGUsIGhhbmRsZXIpO1xuXG4gIGlmIChub25lUmVtYWluaW5nKSB7XG4gICAgZGVsZXRlIGVsZW1lbnQuZXZlbnRPYmplY3RNYXBbZXZlbnRUeXBlXTtcbiAgfVxuXG4gIGNvbnN0IGV2ZW50VHlwZXMgPSBPYmplY3Qua2V5cyhlbGVtZW50LmV2ZW50T2JqZWN0TWFwKTtcblxuICBpZiAoZXZlbnRUeXBlcy5sZW5ndGggPT09IDApIHtcbiAgICBkZWxldGUgZWxlbWVudC5ldmVudE9iamVjdE1hcDtcbiAgfVxufVxuXG5mdW5jdGlvbiBjcmVhdGVFdmVudE9iamVjdCgpIHtcbiAgY29uc3QgZXZlbnRMaXN0ZW5lcnMgPSBbXTtcblxuICBmdW5jdGlvbiBhZGRIYW5kbGVyKGVsZW1lbnQsIGV2ZW50VHlwZSwgaGFuZGxlcikge1xuICAgIGNvbnN0IHRhcmdldEVsZW1lbnQgPSBlbGVtZW50LCAgLy8vXG4gICAgICAgICAgZXZlbnRMaXN0ZW5lciA9IGNyZWF0ZUV2ZW50TGlzdGVuZXIoaGFuZGxlciwgdGFyZ2V0RWxlbWVudCk7XG5cbiAgICBlbGVtZW50LmRvbUVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihldmVudFR5cGUsIGV2ZW50TGlzdGVuZXIpO1xuXG4gICAgZXZlbnRMaXN0ZW5lcnMucHVzaChldmVudExpc3RlbmVyKTtcbiAgfVxuXG4gIGZ1bmN0aW9uIHJlbW92ZUhhbmRsZXIoZXZlbnRUeXBlLCBoYW5kbGVyID0gbnVsbCkge1xuICAgIGlmIChoYW5kbGVyID09PSBudWxsKSB7XG4gICAgICBldmVudExpc3RlbmVycy5mb3JFYWNoKGZ1bmN0aW9uKGV2ZW50TGlzdGVuZXIpIHtcbiAgICAgICAgZWxlbWVudC5kb21FbGVtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoZXZlbnRUeXBlLCBldmVudExpc3RlbmVyKTtcbiAgICAgIH0pO1xuXG4gICAgICBjb25zdCBzdGFydCA9IDA7XG5cbiAgICAgIGV2ZW50TGlzdGVuZXJzLnNwbGljZShzdGFydCk7XG4gICAgfSBlbHNlIHtcbiAgICAgIGNvbnN0IGluZGV4ID0gaW5kZXhPZkV2ZW50TGlzdGVuZXIoZXZlbnRMaXN0ZW5lcnMsIGhhbmRsZXIpLFxuICAgICAgICAgICAgZXZlbnRMaXN0ZW5lciA9IGV2ZW50TGlzdGVuZXJzW2luZGV4XTtcblxuICAgICAgZWxlbWVudC5kb21FbGVtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoZXZlbnRUeXBlLCBldmVudExpc3RlbmVyKTtcblxuICAgICAgY29uc3Qgc3RhcnQgPSBpbmRleCwgIC8vL1xuICAgICAgICAgICAgZGVsZXRlQ291bnQgPSAxO1xuXG4gICAgICBldmVudExpc3RlbmVycy5zcGxpY2Uoc3RhcnQsIGRlbGV0ZUNvdW50KTtcbiAgICB9XG5cbiAgICBjb25zdCBub25lUmVtYWluaW5nID0gKGV2ZW50TGlzdGVuZXJzLmxlbmd0aCA9PT0gMCk7ICAvLy9cblxuICAgIHJldHVybiBub25lUmVtYWluaW5nO1xuICB9XG5cbiAgcmV0dXJuIHtcbiAgICBhZGRIYW5kbGVyOiBhZGRIYW5kbGVyLFxuICAgIHJlbW92ZUhhbmRsZXI6IHJlbW92ZUhhbmRsZXJcbiAgfTtcbn1cblxuZnVuY3Rpb24gaW5kZXhPZkV2ZW50TGlzdGVuZXIoZXZlbnRMaXN0ZW5lcnMsIGhhbmRsZXIpIHtcbiAgbGV0IGZvdW5kSW5kZXggPSB1bmRlZmluZWQ7IC8vL1xuXG4gIGV2ZW50TGlzdGVuZXJzLmZvckVhY2goZnVuY3Rpb24oZXZlbnRMaXN0ZW5lciwgaW5kZXgpIHtcbiAgICBpZiAoZXZlbnRMaXN0ZW5lci5oYW5kbGVyID09PSBoYW5kbGVyKSB7XG4gICAgICBmb3VuZEluZGV4ID0gaW5kZXg7XG4gICAgfVxuICB9KTtcblxuICBjb25zdCBpbmRleCA9IGZvdW5kSW5kZXg7IC8vL1xuXG4gIHJldHVybiBpbmRleDtcbn1cblxuZnVuY3Rpb24gY3JlYXRlRXZlbnRMaXN0ZW5lcihoYW5kbGVyLCB0YXJnZXRFbGVtZW50KSB7XG4gIGNvbnN0IGV2ZW50TGlzdGVuZXIgPSBmdW5jdGlvbihldmVudCkge1xuICAgIGNvbnN0IGhhbmRsZXIgPSB0aGlzLmhhbmRsZXIsXG4gICAgICAgICAgcHJldmVudERlZmF1bHQgPSAoaGFuZGxlci5pbnRlcm1lZGlhdGVIYW5kbGVyICE9PSB1bmRlZmluZWQpID9cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGhhbmRsZXIuaW50ZXJtZWRpYXRlSGFuZGxlcihoYW5kbGVyLCBldmVudCwgdGFyZ2V0RWxlbWVudCkgOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBoYW5kbGVyKGV2ZW50LCB0YXJnZXRFbGVtZW50KTtcblxuICAgIGlmIChwcmV2ZW50RGVmYXVsdCA9PT0gdHJ1ZSkge1xuICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcbiAgICB9XG5cbiAgICBldmVudC5zdG9wUHJvcGFnYXRpb24oKTtcbiAgfTtcblxuICBldmVudExpc3RlbmVyLmhhbmRsZXIgPSBoYW5kbGVyOyAgLy8vXG5cbiAgcmV0dXJuIGV2ZW50TGlzdGVuZXI7XG59XG4iXX0=