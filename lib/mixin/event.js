'use strict';

function on(eventTypes, handler, intermediateHandler) {
  eventTypes = eventTypes.split(' '); ///

  eventTypes.forEach(function (eventType) {
    onEvent(this, eventType, handler, intermediateHandler);
  }.bind(this));
}

function off(eventTypes, handler) {
  eventTypes = eventTypes.split(' '); ///

  eventTypes.forEach(function (eventType) {
    offEvent(this, eventType, handler);
  }.bind(this));
}

var eventMixin = {
  on: on,
  off: off
};

module.exports = eventMixin;

function onEvent(element, eventType, handler, intermediateHandler) {
  if (!Object.hasOwnProperty('eventObjectMap')) {
    var eventObjectMap = {};

    Object.assign(element, {
      eventObjectMap: eventObjectMap
    });
  }

  var eventObject = element.eventObjectMap[eventType];

  if (!eventObject) {
    eventObject = createEventObject();

    element.eventObjectMap[eventType] = eventObject;
  }

  eventObject.addHandler(element, eventType, handler, intermediateHandler);
}

function offEvent(element, eventType, handler) {
  var eventObject = element.eventObjectMap[eventType],
      noneRemaining = eventObject.removeHandler(element, eventType, handler);

  if (noneRemaining) {
    delete element.eventObjectMap[eventType];
  }

  var eventTypes = Object.keys(element.eventObjectMap);

  if (eventTypes.length === 0) {
    delete element.eventObjectMap;
  }
}

function createEventObject() {
  var eventListeners = [];

  function addHandler(element, eventType, handler, intermediateHandler) {
    var targetElement = element,
        ///
    eventListener = createEventListener(handler, intermediateHandler, targetElement);

    element.domElement.addEventListener(eventType, eventListener);

    eventListeners.push(eventListener);
  }

  function removeHandler(element, eventType) {
    var handler = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : null;

    if (handler === null) {
      eventListeners.forEach(function (eventListener) {
        element.domElement.removeEventListener(eventType, eventListener);
      });

      var start = 0;

      eventListeners.splice(start);
    } else {
      var index = indexOfEventListener(eventListeners, handler),
          eventListener = eventListeners[index];

      element.domElement.removeEventListener(eventType, eventListener);

      var _start = index,
          ///
      deleteCount = 1;

      eventListeners.splice(_start, deleteCount);
    }

    var noneRemaining = eventListeners.length === 0; ///

    return noneRemaining;
  }

  return {
    addHandler: addHandler,
    removeHandler: removeHandler
  };
}

function indexOfEventListener(eventListeners, handler) {
  var foundIndex = undefined; ///

  eventListeners.forEach(function (eventListener, index) {
    if (eventListener.handler === handler) {
      ///
      foundIndex = index;
    }
  });

  var index = foundIndex; ///

  return index;
}

function createEventListener(handler, intermediateHandler, targetElement) {
  var eventListener = function eventListener(event) {
    var preventDefault = intermediateHandler !== undefined ? intermediateHandler(handler, event, targetElement) : handler(event, targetElement);

    if (preventDefault === true) {
      event.preventDefault();
    }

    event.stopPropagation();
  };

  Object.assign(eventListener, {
    handler: handler
  });

  return eventListener;
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL2VzNi9taXhpbi9ldmVudC5qcyJdLCJuYW1lcyI6WyJvbiIsImV2ZW50VHlwZXMiLCJoYW5kbGVyIiwiaW50ZXJtZWRpYXRlSGFuZGxlciIsInNwbGl0IiwiZm9yRWFjaCIsImV2ZW50VHlwZSIsIm9uRXZlbnQiLCJiaW5kIiwib2ZmIiwib2ZmRXZlbnQiLCJldmVudE1peGluIiwibW9kdWxlIiwiZXhwb3J0cyIsImVsZW1lbnQiLCJPYmplY3QiLCJoYXNPd25Qcm9wZXJ0eSIsImV2ZW50T2JqZWN0TWFwIiwiYXNzaWduIiwiZXZlbnRPYmplY3QiLCJjcmVhdGVFdmVudE9iamVjdCIsImFkZEhhbmRsZXIiLCJub25lUmVtYWluaW5nIiwicmVtb3ZlSGFuZGxlciIsImtleXMiLCJsZW5ndGgiLCJldmVudExpc3RlbmVycyIsInRhcmdldEVsZW1lbnQiLCJldmVudExpc3RlbmVyIiwiY3JlYXRlRXZlbnRMaXN0ZW5lciIsImRvbUVsZW1lbnQiLCJhZGRFdmVudExpc3RlbmVyIiwicHVzaCIsInJlbW92ZUV2ZW50TGlzdGVuZXIiLCJzdGFydCIsInNwbGljZSIsImluZGV4IiwiaW5kZXhPZkV2ZW50TGlzdGVuZXIiLCJkZWxldGVDb3VudCIsImZvdW5kSW5kZXgiLCJ1bmRlZmluZWQiLCJldmVudCIsInByZXZlbnREZWZhdWx0Iiwic3RvcFByb3BhZ2F0aW9uIl0sIm1hcHBpbmdzIjoiQUFBQTs7QUFFQSxTQUFTQSxFQUFULENBQVlDLFVBQVosRUFBd0JDLE9BQXhCLEVBQWlDQyxtQkFBakMsRUFBc0Q7QUFDcERGLGVBQWFBLFdBQVdHLEtBQVgsQ0FBaUIsR0FBakIsQ0FBYixDQURvRCxDQUNoQjs7QUFFcENILGFBQVdJLE9BQVgsQ0FBbUIsVUFBU0MsU0FBVCxFQUFvQjtBQUNyQ0MsWUFBUSxJQUFSLEVBQWNELFNBQWQsRUFBeUJKLE9BQXpCLEVBQWtDQyxtQkFBbEM7QUFDRCxHQUZrQixDQUVqQkssSUFGaUIsQ0FFWixJQUZZLENBQW5CO0FBR0Q7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dkIsRUFBNkI7QUFDM0JELFlBQU1DLGNBQU47QUFDRDs7QUFFREQsVUFBTUUsZUFBTjtBQUNELEdBVkQ7O0FBWUE1QixTQUFPRyxNQUFQLENBQWNVLGFBQWQsRUFBNkI7QUFDM0IxQixhQUFTQTtBQURrQixHQUE3Qjs7QUFJQSxTQUFPMEIsYUFBUDtBQUNEIiwiZmlsZSI6ImV2ZW50LmpzIiwic291cmNlc0NvbnRlbnQiOlsiJ3VzZSBzdHJpY3QnO1xuXG5mdW5jdGlvbiBvbihldmVudFR5cGVzLCBoYW5kbGVyLCBpbnRlcm1lZGlhdGVIYW5kbGVyKSB7XG4gIGV2ZW50VHlwZXMgPSBldmVudFR5cGVzLnNwbGl0KCcgJyk7IC8vL1xuXG4gIGV2ZW50VHlwZXMuZm9yRWFjaChmdW5jdGlvbihldmVudFR5cGUpIHtcbiAgICBvbkV2ZW50KHRoaXMsIGV2ZW50VHlwZSwgaGFuZGxlciwgaW50ZXJtZWRpYXRlSGFuZGxlcik7XG4gIH0uYmluZCh0aGlzKSk7XG59XG5cbmZ1bmN0aW9uIG9mZihldmVudFR5cGVzLCBoYW5kbGVyKSB7XG4gIGV2ZW50VHlwZXMgPSBldmVudFR5cGVzLnNwbGl0KCcgJyk7IC8vL1xuXG4gIGV2ZW50VHlwZXMuZm9yRWFjaChmdW5jdGlvbihldmVudFR5cGUpIHtcbiAgICBvZmZFdmVudCh0aGlzLCBldmVudFR5cGUsIGhhbmRsZXIpO1xuICB9LmJpbmQodGhpcykpO1xufVxuXG5jb25zdCBldmVudE1peGluID0ge1xuICBvbjogb24sXG4gIG9mZjogb2ZmXG59O1xuXG5tb2R1bGUuZXhwb3J0cyA9IGV2ZW50TWl4aW47XG5cbmZ1bmN0aW9uIG9uRXZlbnQoZWxlbWVudCwgZXZlbnRUeXBlLCBoYW5kbGVyLCBpbnRlcm1lZGlhdGVIYW5kbGVyKSB7XG4gIGlmICghT2JqZWN0Lmhhc093blByb3BlcnR5KCdldmVudE9iamVjdE1hcCcpKSB7XG4gICAgY29uc3QgZXZlbnRPYmplY3RNYXAgPSB7fTtcblxuICAgIE9iamVjdC5hc3NpZ24oZWxlbWVudCwge1xuICAgICAgZXZlbnRPYmplY3RNYXA6IGV2ZW50T2JqZWN0TWFwXG4gICAgfSk7XG4gIH1cblxuICBsZXQgZXZlbnRPYmplY3QgPSBlbGVtZW50LmV2ZW50T2JqZWN0TWFwW2V2ZW50VHlwZV07XG5cbiAgaWYgKCFldmVudE9iamVjdCkge1xuICAgIGV2ZW50T2JqZWN0ID0gY3JlYXRlRXZlbnRPYmplY3QoKTtcblxuICAgIGVsZW1lbnQuZXZlbnRPYmplY3RNYXBbZXZlbnRUeXBlXSA9IGV2ZW50T2JqZWN0O1xuICB9XG5cbiAgZXZlbnRPYmplY3QuYWRkSGFuZGxlcihlbGVtZW50LCBldmVudFR5cGUsIGhhbmRsZXIsIGludGVybWVkaWF0ZUhhbmRsZXIpO1xufVxuXG5mdW5jdGlvbiBvZmZFdmVudChlbGVtZW50LCBldmVudFR5cGUsIGhhbmRsZXIpIHtcbiAgY29uc3QgZXZlbnRPYmplY3QgPSBlbGVtZW50LmV2ZW50T2JqZWN0TWFwW2V2ZW50VHlwZV0sXG4gICAgICAgIG5vbmVSZW1haW5pbmcgPSBldmVudE9iamVjdC5yZW1vdmVIYW5kbGVyKGVsZW1lbnQsIGV2ZW50VHlwZSwgaGFuZGxlcik7XG5cbiAgaWYgKG5vbmVSZW1haW5pbmcpIHtcbiAgICBkZWxldGUgZWxlbWVudC5ldmVudE9iamVjdE1hcFtldmVudFR5cGVdO1xuICB9XG5cbiAgY29uc3QgZXZlbnRUeXBlcyA9IE9iamVjdC5rZXlzKGVsZW1lbnQuZXZlbnRPYmplY3RNYXApO1xuXG4gIGlmIChldmVudFR5cGVzLmxlbmd0aCA9PT0gMCkge1xuICAgIGRlbGV0ZSBlbGVtZW50LmV2ZW50T2JqZWN0TWFwO1xuICB9XG59XG5cbmZ1bmN0aW9uIGNyZWF0ZUV2ZW50T2JqZWN0KCkge1xuICBjb25zdCBldmVudExpc3RlbmVycyA9IFtdO1xuXG4gIGZ1bmN0aW9uIGFkZEhhbmRsZXIoZWxlbWVudCwgZXZlbnRUeXBlLCBoYW5kbGVyLCBpbnRlcm1lZGlhdGVIYW5kbGVyKSB7XG4gICAgY29uc3QgdGFyZ2V0RWxlbWVudCA9IGVsZW1lbnQsICAvLy9cbiAgICAgICAgICBldmVudExpc3RlbmVyID0gY3JlYXRlRXZlbnRMaXN0ZW5lcihoYW5kbGVyLCBpbnRlcm1lZGlhdGVIYW5kbGVyLCB0YXJnZXRFbGVtZW50KTtcblxuICAgIGVsZW1lbnQuZG9tRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKGV2ZW50VHlwZSwgZXZlbnRMaXN0ZW5lcik7XG5cbiAgICBldmVudExpc3RlbmVycy5wdXNoKGV2ZW50TGlzdGVuZXIpO1xuICB9XG5cbiAgZnVuY3Rpb24gcmVtb3ZlSGFuZGxlcihlbGVtZW50LCBldmVudFR5cGUsIGhhbmRsZXIgPSBudWxsKSB7XG4gICAgaWYgKGhhbmRsZXIgPT09IG51bGwpIHtcbiAgICAgIGV2ZW50TGlzdGVuZXJzLmZvckVhY2goZnVuY3Rpb24oZXZlbnRMaXN0ZW5lcikge1xuICAgICAgICBlbGVtZW50LmRvbUVsZW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcihldmVudFR5cGUsIGV2ZW50TGlzdGVuZXIpO1xuICAgICAgfSk7XG5cbiAgICAgIGNvbnN0IHN0YXJ0ID0gMDtcblxuICAgICAgZXZlbnRMaXN0ZW5lcnMuc3BsaWNlKHN0YXJ0KTtcbiAgICB9IGVsc2Uge1xuICAgICAgY29uc3QgaW5kZXggPSBpbmRleE9mRXZlbnRMaXN0ZW5lcihldmVudExpc3RlbmVycywgaGFuZGxlciksXG4gICAgICAgICAgICBldmVudExpc3RlbmVyID0gZXZlbnRMaXN0ZW5lcnNbaW5kZXhdO1xuXG4gICAgICBlbGVtZW50LmRvbUVsZW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcihldmVudFR5cGUsIGV2ZW50TGlzdGVuZXIpO1xuXG4gICAgICBjb25zdCBzdGFydCA9IGluZGV4LCAgLy8vXG4gICAgICAgICAgICBkZWxldGVDb3VudCA9IDE7XG5cbiAgICAgIGV2ZW50TGlzdGVuZXJzLnNwbGljZShzdGFydCwgZGVsZXRlQ291bnQpO1xuICAgIH1cblxuICAgIGNvbnN0IG5vbmVSZW1haW5pbmcgPSAoZXZlbnRMaXN0ZW5lcnMubGVuZ3RoID09PSAwKTsgIC8vL1xuXG4gICAgcmV0dXJuIG5vbmVSZW1haW5pbmc7XG4gIH1cblxuICByZXR1cm4ge1xuICAgIGFkZEhhbmRsZXI6IGFkZEhhbmRsZXIsXG4gICAgcmVtb3ZlSGFuZGxlcjogcmVtb3ZlSGFuZGxlclxuICB9O1xufVxuXG5mdW5jdGlvbiBpbmRleE9mRXZlbnRMaXN0ZW5lcihldmVudExpc3RlbmVycywgaGFuZGxlcikge1xuICBsZXQgZm91bmRJbmRleCA9IHVuZGVmaW5lZDsgLy8vXG5cbiAgZXZlbnRMaXN0ZW5lcnMuZm9yRWFjaChmdW5jdGlvbihldmVudExpc3RlbmVyLCBpbmRleCkge1xuICAgIGlmIChldmVudExpc3RlbmVyLmhhbmRsZXIgPT09IGhhbmRsZXIpIHsgIC8vL1xuICAgICAgZm91bmRJbmRleCA9IGluZGV4O1xuICAgIH1cbiAgfSk7XG5cbiAgY29uc3QgaW5kZXggPSBmb3VuZEluZGV4OyAvLy9cblxuICByZXR1cm4gaW5kZXg7XG59XG5cbmZ1bmN0aW9uIGNyZWF0ZUV2ZW50TGlzdGVuZXIoaGFuZGxlciwgaW50ZXJtZWRpYXRlSGFuZGxlciwgdGFyZ2V0RWxlbWVudCkge1xuICBjb25zdCBldmVudExpc3RlbmVyID0gZnVuY3Rpb24oZXZlbnQpIHtcbiAgICBjb25zdCBwcmV2ZW50RGVmYXVsdCA9IChpbnRlcm1lZGlhdGVIYW5kbGVyICE9PSB1bmRlZmluZWQpID9cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGludGVybWVkaWF0ZUhhbmRsZXIoaGFuZGxlciwgZXZlbnQsIHRhcmdldEVsZW1lbnQpIDpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaGFuZGxlcihldmVudCwgdGFyZ2V0RWxlbWVudCk7XG5cbiAgICBpZiAocHJldmVudERlZmF1bHQgPT09IHRydWUpIHtcbiAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG4gICAgfVxuXG4gICAgZXZlbnQuc3RvcFByb3BhZ2F0aW9uKCk7XG4gIH07XG5cbiAgT2JqZWN0LmFzc2lnbihldmVudExpc3RlbmVyLCB7XG4gICAgaGFuZGxlcjogaGFuZGxlclxuICB9KTtcblxuICByZXR1cm4gZXZlbnRMaXN0ZW5lcjtcbn1cbiJdfQ==