'use strict';

function on(eventTypes, handler) {
  eventTypes = eventTypes.split(' '); ///

  eventTypes.forEach(function (eventType) {
    onEvent(this, eventType, handler);
  }.bind(this));
}

function off(eventTypes, handler) {
  eventTypes = eventTypes.split(' '); ///

  eventTypes.forEach(function (eventType) {
    offEvent(this, eventType, handler);
  }.bind(this));
}

var eventMixin = {
  on: on,
  off: off
};

module.exports = eventMixin;

function onEvent(element, eventType, handler) {
  if (element.eventObjectMap === undefined) {
    element.eventObjectMap = {};
  }

  var eventObject = element.eventObjectMap[eventType];

  if (!eventObject) {
    eventObject = createEventObject();

    element.eventObjectMap[eventType] = eventObject;
  }

  eventObject.addHandler(element, eventType, handler);
}

function offEvent(element, eventType, handler) {
  var eventObject = element.eventObjectMap[eventType],
      noneRemaining = eventObject.removeHandler(eventType, handler);

  if (noneRemaining) {
    delete element.eventObjectMap[eventType];
  }

  var eventTypes = Object.keys(element.eventObjectMap);

  if (eventTypes.length === 0) {
    delete element.eventObjectMap;
  }
}

function createEventObject() {
  var eventListeners = [];

  function addHandler(element, eventType, handler) {
    var targetElement = element,
        ///
    eventListener = createEventListener(handler, targetElement);

    element.domElement.addEventListener(eventType, eventListener);

    eventListeners.push(eventListener);
  }

  function removeHandler(eventType) {
    var handler = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : null;

    if (handler === null) {
      eventListeners.forEach(function (eventListener) {
        element.domElement.removeEventListener(eventType, eventListener);
      });

      var start = 0;

      eventListeners.splice(start);
    } else {
      var index = indexOfEventListener(eventListeners, handler),
          eventListener = eventListeners[index];

      element.domElement.removeEventListener(eventType, eventListener);

      var _start = index,
          ///
      deleteCount = 1;

      eventListeners.splice(_start, deleteCount);
    }

    var noneRemaining = eventListeners.length === 0; ///

    return noneRemaining;
  }

  return {
    addHandler: addHandler,
    removeHandler: removeHandler
  };
}

function indexOfEventListener(eventListeners, handler) {
  var foundIndex = undefined; ///

  eventListeners.forEach(function (eventListener, index) {
    if (eventListener.handler === handler) {
      foundIndex = index;
    }
  });

  var index = foundIndex; ///

  return index;
}

function createEventListener(handler, targetElement) {
  var eventListener = function eventListener(event) {
    var preventDefault = handler.intermediateHandler !== undefined ? handler.intermediateHandler(handler, event, targetElement) : handler(event, targetElement);

    if (preventDefault === true) {
      event.preventDefault();
    }

    event.stopPropagation();
  };

  eventListener.handler = handler; ///

  return eventListener;
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL2VzNi9taXhpbi9ldmVudC5qcyJdLCJuYW1lcyI6WyJvbiIsImV2ZW50VHlwZXMiLCJoYW5kbGVyIiwic3BsaXQiLCJmb3JFYWNoIiwiZXZlbnRUeXBlIiwib25FdmVudCIsImJpbmQiLCJvZmYiLCJvZmZFdmVudCIsImV2ZW50TWl4aW4iLCJtb2R1bGUiLCJleHBvcnRzIiwiZWxlbWVudCIsImV2ZW50T2JqZWN0TWFwIiwidW5kZWZpbmVkIiwiZXZlbnRPYmplY3QiLCJjcmVhdGVFdmVudE9iamVjdCIsImFkZEhhbmRsZXIiLCJub25lUmVtYWluaW5nIiwicmVtb3ZlSGFuZGxlciIsIk9iamVjdCIsImtleXMiLCJsZW5ndGgiLCJldmVudExpc3RlbmVycyIsInRhcmdldEVsZW1lbnQiLCJldmVudExpc3RlbmVyIiwiY3JlYXRlRXZlbnRMaXN0ZW5lciIsImRvbUVsZW1lbnQiLCJhZGRFdmVudExpc3RlbmVyIiwicHVzaCIsInJlbW92ZUV2ZW50TGlzdGVuZXIiLCJzdGFydCIsInNwbGljZSIsImluZGV4IiwiaW5kZXhPZkV2ZW50TGlzdGVuZXIiLCJkZWxldGVDb3VudCIsImZvdW5kSW5kZXgiLCJldmVudCIsInByZXZlbnREZWZhdWx0IiwiaW50ZXJtZWRpYXRlSGFuZGxlciIsInN0b3BQcm9wYWdhdGlvbiJdLCJtYXBwaW5ncyI6IkFBQUE7O0FBRUEsU0FBU0EsRUFBVCxDQUFZQyxVQUFaLEVBQXdCQyxPQUF4QixFQUFpQztBQUMvQkQsZUFBYUEsV0FBV0UsS0FBWCxDQUFpQixHQUFqQixDQUFiLENBRCtCLENBQ0s7O0FBRXBDRixhQUFXRyxPQUFYLENBQW1CLFVBQVNDLFNBQVQsRUFBb0I7QUFDckNDLFlBQVEsSUFBUixFQUFjRCxTQUFkLEVBQXlCSCxPQUF6QjtBQUNELEdBRmtCLENBRWpCSyxJQUZpQixDQUVaLElBRlksQ0FBbkI7QUFHRDs7QUFFRCxTQUFTQyxHQUFULENBQWFQLFVBQWIsRUFBeUJDLE9BQXpCLEVBQWtDO0FBQ2hDRCxl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eXBlcywgaGFuZGxlcikge1xuICBldmVudFR5cGVzID0gZXZlbnRUeXBlcy5zcGxpdCgnICcpOyAvLy9cblxuICBldmVudFR5cGVzLmZvckVhY2goZnVuY3Rpb24oZXZlbnRUeXBlKSB7XG4gICAgb25FdmVudCh0aGlzLCBldmVudFR5cGUsIGhhbmRsZXIpO1xuICB9LmJpbmQodGhpcykpO1xufVxuXG5mdW5jdGlvbiBvZmYoZXZlbnRUeXBlcywgaGFuZGxlcikge1xuICBldmVudFR5cGVzID0gZXZlbnRUeXBlcy5zcGxpdCgnICcpOyAvLy9cblxuICBldmVudFR5cGVzLmZvckVhY2goZnVuY3Rpb24oZXZlbnRUeXBlKSB7XG4gICAgb2ZmRXZlbnQodGhpcywgZXZlbnRUeXBlLCBoYW5kbGVyKTtcbiAgfS5iaW5kKHRoaXMpKTtcbn1cblxuY29uc3QgZXZlbnRNaXhpbiA9IHtcbiAgb246IG9uLFxuICBvZmY6IG9mZlxufTtcblxubW9kdWxlLmV4cG9ydHMgPSBldmVudE1peGluO1xuXG5mdW5jdGlvbiBvbkV2ZW50KGVsZW1lbnQsIGV2ZW50VHlwZSwgaGFuZGxlcikge1xuICBpZiAoZWxlbWVudC5ldmVudE9iamVjdE1hcCA9PT0gdW5kZWZpbmVkKSB7XG4gICAgZWxlbWVudC5ldmVudE9iamVjdE1hcCA9IHt9O1xuICB9XG5cbiAgbGV0IGV2ZW50T2JqZWN0ID0gZWxlbWVudC5ldmVudE9iamVjdE1hcFtldmVudFR5cGVdO1xuXG4gIGlmICghZXZlbnRPYmplY3QpIHtcbiAgICBldmVudE9iamVjdCA9IGNyZWF0ZUV2ZW50T2JqZWN0KCk7XG5cbiAgICBlbGVtZW50LmV2ZW50T2JqZWN0TWFwW2V2ZW50VHlwZV0gPSBldmVudE9iamVjdDtcbiAgfVxuXG4gIGV2ZW50T2JqZWN0LmFkZEhhbmRsZXIoZWxlbWVudCwgZXZlbnRUeXBlLCBoYW5kbGVyKTtcbn1cblxuZnVuY3Rpb24gb2ZmRXZlbnQoZWxlbWVudCwgZXZlbnRUeXBlLCBoYW5kbGVyKSB7XG4gIGNvbnN0IGV2ZW50T2JqZWN0ID0gZWxlbWVudC5ldmVudE9iamVjdE1hcFtldmVudFR5cGVdLFxuICAgICAgICBub25lUmVtYWluaW5nID0gZXZlbnRPYmplY3QucmVtb3ZlSGFuZGxlcihldmVudFR5cGUsIGhhbmRsZXIpO1xuXG4gIGlmIChub25lUmVtYWluaW5nKSB7XG4gICAgZGVsZXRlIGVsZW1lbnQuZXZlbnRPYmplY3RNYXBbZXZlbnRUeXBlXTtcbiAgfVxuXG4gIGNvbnN0IGV2ZW50VHlwZXMgPSBPYmplY3Qua2V5cyhlbGVtZW50LmV2ZW50T2JqZWN0TWFwKTtcblxuICBpZiAoZXZlbnRUeXBlcy5sZW5ndGggPT09IDApIHtcbiAgICBkZWxldGUgZWxlbWVudC5ldmVudE9iamVjdE1hcDtcbiAgfVxufVxuXG5mdW5jdGlvbiBjcmVhdGVFdmVudE9iamVjdCgpIHtcbiAgY29uc3QgZXZlbnRMaXN0ZW5lcnMgPSBbXTtcblxuICBmdW5jdGlvbiBhZGRIYW5kbGVyKGVsZW1lbnQsIGV2ZW50VHlwZSwgaGFuZGxlcikge1xuICAgIGNvbnN0IHRhcmdldEVsZW1lbnQgPSBlbGVtZW50LCAgLy8vXG4gICAgICAgICAgZXZlbnRMaXN0ZW5lciA9IGNyZWF0ZUV2ZW50TGlzdGVuZXIoaGFuZGxlciwgdGFyZ2V0RWxlbWVudCk7XG5cbiAgICBlbGVtZW50LmRvbUVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihldmVudFR5cGUsIGV2ZW50TGlzdGVuZXIpO1xuXG4gICAgZXZlbnRMaXN0ZW5lcnMucHVzaChldmVudExpc3RlbmVyKTtcbiAgfVxuXG4gIGZ1bmN0aW9uIHJlbW92ZUhhbmRsZXIoZXZlbnRUeXBlLCBoYW5kbGVyID0gbnVsbCkge1xuICAgIGlmIChoYW5kbGVyID09PSBudWxsKSB7XG4gICAgICBldmVudExpc3RlbmVycy5mb3JFYWNoKGZ1bmN0aW9uKGV2ZW50TGlzdGVuZXIpIHtcbiAgICAgICAgZWxlbWVudC5kb21FbGVtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoZXZlbnRUeXBlLCBldmVudExpc3RlbmVyKTtcbiAgICAgIH0pO1xuXG4gICAgICBjb25zdCBzdGFydCA9IDA7XG5cbiAgICAgIGV2ZW50TGlzdGVuZXJzLnNwbGljZShzdGFydCk7XG4gICAgfSBlbHNlIHtcbiAgICAgIGNvbnN0IGluZGV4ID0gaW5kZXhPZkV2ZW50TGlzdGVuZXIoZXZlbnRMaXN0ZW5lcnMsIGhhbmRsZXIpLFxuICAgICAgICAgICAgZXZlbnRMaXN0ZW5lciA9IGV2ZW50TGlzdGVuZXJzW2luZGV4XTtcblxuICAgICAgZWxlbWVudC5kb21FbGVtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoZXZlbnRUeXBlLCBldmVudExpc3RlbmVyKTtcblxuICAgICAgY29uc3Qgc3RhcnQgPSBpbmRleCwgIC8vL1xuICAgICAgICAgICAgZGVsZXRlQ291bnQgPSAxO1xuXG4gICAgICBldmVudExpc3RlbmVycy5zcGxpY2Uoc3RhcnQsIGRlbGV0ZUNvdW50KTtcbiAgICB9XG5cbiAgICBjb25zdCBub25lUmVtYWluaW5nID0gKGV2ZW50TGlzdGVuZXJzLmxlbmd0aCA9PT0gMCk7ICAvLy9cblxuICAgIHJldHVybiBub25lUmVtYWluaW5nO1xuICB9XG5cbiAgcmV0dXJuIHtcbiAgICBhZGRIYW5kbGVyOiBhZGRIYW5kbGVyLFxuICAgIHJlbW92ZUhhbmRsZXI6IHJlbW92ZUhhbmRsZXJcbiAgfTtcbn1cblxuZnVuY3Rpb24gaW5kZXhPZkV2ZW50TGlzdGVuZXIoZXZlbnRMaXN0ZW5lcnMsIGhhbmRsZXIpIHtcbiAgbGV0IGZvdW5kSW5kZXggPSB1bmRlZmluZWQ7IC8vL1xuXG4gIGV2ZW50TGlzdGVuZXJzLmZvckVhY2goZnVuY3Rpb24oZXZlbnRMaXN0ZW5lciwgaW5kZXgpIHtcbiAgICBpZiAoZXZlbnRMaXN0ZW5lci5oYW5kbGVyID09PSBoYW5kbGVyKSB7XG4gICAgICBmb3VuZEluZGV4ID0gaW5kZXg7XG4gICAgfVxuICB9KTtcblxuICBjb25zdCBpbmRleCA9IGZvdW5kSW5kZXg7IC8vL1xuXG4gIHJldHVybiBpbmRleDtcbn1cblxuZnVuY3Rpb24gY3JlYXRlRXZlbnRMaXN0ZW5lcihoYW5kbGVyLCB0YXJnZXRFbGVtZW50KSB7XG4gIGNvbnN0IGV2ZW50TGlzdGVuZXIgPSBmdW5jdGlvbihldmVudCkge1xuICAgIGNvbnN0IHByZXZlbnREZWZhdWx0ID0gKGhhbmRsZXIuaW50ZXJtZWRpYXRlSGFuZGxlciAhPT0gdW5kZWZpbmVkKSA/XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICBoYW5kbGVyLmludGVybWVkaWF0ZUhhbmRsZXIoaGFuZGxlciwgZXZlbnQsIHRhcmdldEVsZW1lbnQpIDpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaGFuZGxlcihldmVudCwgdGFyZ2V0RWxlbWVudCk7XG5cbiAgICBpZiAocHJldmVudERlZmF1bHQgPT09IHRydWUpIHtcbiAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG4gICAgfVxuXG4gICAgZXZlbnQuc3RvcFByb3BhZ2F0aW9uKCk7XG4gIH07XG5cbiAgZXZlbnRMaXN0ZW5lci5oYW5kbGVyID0gaGFuZGxlcjsgIC8vL1xuXG4gIHJldHVybiBldmVudExpc3RlbmVyO1xufVxuIl19