'use strict';

function on(eventTypes, handler) {
  eventTypes = eventTypes.split(' '); ///

  eventTypes.forEach(function (eventType) {
    onEvent(this, eventType, handler);
  }.bind(this));
}

function off(eventTypes, handler) {
  eventTypes = eventTypes.split(' '); ///

  eventTypes.forEach(function (eventType) {
    offEvent(this, eventType, handler);
  }.bind(this));
}

var eventMixin = {
  on: on,
  off: off
};

module.exports = eventMixin;

function onEvent(element, eventType, handler) {
  if (element.eventObjectMap === undefined) {
    element.eventObjectMap = {};
  }

  var eventObject = element.eventObjectMap[eventType];

  if (!eventObject) {
    eventObject = createEventObject();

    element.eventObjectMap[eventType] = eventObject;
  }

  eventObject.addHandler(element, eventType, handler);
}

function offEvent(element, eventType, handler) {
  var eventObject = element.eventObjectMap[eventType],
      noneRemaining = eventObject.removeHandler(element, eventType, handler);

  if (noneRemaining) {
    delete element.eventObjectMap[eventType];
  }

  var eventTypes = Object.keys(element.eventObjectMap);

  if (eventTypes.length === 0) {
    delete element.eventObjectMap;
  }
}

function createEventObject() {
  var eventListeners = [];

  function addHandler(element, eventType, handler) {
    var targetElement = element,
        ///
    eventListener = createEventListener(handler, targetElement);

    element.domElement.addEventListener(eventType, eventListener);

    eventListeners.push(eventListener);
  }

  function removeHandler(element, eventType) {
    var handler = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : null;

    if (handler === null) {
      eventListeners.forEach(function (eventListener) {
        element.domElement.removeEventListener(eventType, eventListener);
      });

      var start = 0;

      eventListeners.splice(start);
    } else {
      var index = indexOfEventListener(eventListeners, handler),
          eventListener = eventListeners[index];

      element.domElement.removeEventListener(eventType, eventListener);

      var _start = index,
          ///
      deleteCount = 1;

      eventListeners.splice(_start, deleteCount);
    }

    var noneRemaining = eventListeners.length === 0; ///

    return noneRemaining;
  }

  return {
    addHandler: addHandler,
    removeHandler: removeHandler
  };
}

function indexOfEventListener(eventListeners, handler) {
  var foundIndex = undefined; ///

  eventListeners.forEach(function (eventListener, index) {
    if (eventListener.handler === handler) {
      foundIndex = index;
    }
  });

  var index = foundIndex; ///

  return index;
}

function createEventListener(handler, targetElement) {
  var eventListener = function eventListener(event) {
    var preventDefault = handler.intermediateHandler !== undefined ? handler.intermediateHandler(handler, event, targetElement) : handler(event, targetElement);

    if (preventDefault === true) {
      event.preventDefault();
    }

    event.stopPropagation();
  };

  eventListener.handler = handler; ///

  return eventListener;
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL2VzNi9taXhpbi9ldmVudC5qcyJdLCJuYW1lcyI6WyJvbiIsImV2ZW50VHlwZXMiLCJoYW5kbGVyIiwic3BsaXQiLCJmb3JFYWNoIiwiZXZlbnRUeXBlIiwib25FdmVudCIsImJpbmQiLCJvZmYiLCJvZmZFdmVudCIsImV2ZW50TWl4aW4iLCJtb2R1bGUiLCJleHBvcnRzIiwiZWxlbWVudCIsImV2ZW50T2JqZWN0TWFwIiwidW5kZWZpbmVkIiwiZXZlbnRPYmplY3QiLCJjcmVhdGVFdmVudE9iamVjdCIsImFkZEhhbmRsZXIiLCJub25lUmVtYWluaW5nIiwicmVtb3ZlSGFuZGxlciIsIk9iamVjdCIsImtleXMiLCJsZW5ndGgiLCJldmVudExpc3RlbmVycyIsInRhcmdldEVsZW1lbnQiLCJldmVudExpc3RlbmVyIiwiY3JlYXRlRXZlbnRMaXN0ZW5lciIsImRvbUVsZW1lbnQiLCJhZGRFdmVudExpc3RlbmVyIiwicHVzaCIsInJlbW92ZUV2ZW50TGlzdGVuZXIiLCJzdGFydCIsInNwbGljZSIsImluZGV4IiwiaW5kZXhPZkV2ZW50TGlzdGVuZXIiLCJkZWxldGVDb3VudCIsImZvdW5kSW5kZXgiLCJldmVudCIsInByZXZlbnREZWZhdWx0IiwiaW50ZXJtZWRpYXRlSGFuZGxlciIsInN0b3BQcm9wYWdhdGlvbiJdLCJtYXBwaW5ncyI6IkFBQUE7O0FBRUEsU0FBU0EsRUFBVCxDQUFZQyxVQUFaLEVBQXdCQyxPQUF4QixFQUFpQztBQUMvQkQsZUFBYUEsV0FBV0UsS0FBWCxDQUFpQixHQUFqQixDQUFiLENBRCtCLENBQ0s7O0FBRXBDRixhQUFXRyxPQUFYLENBQW1CLFVBQVNDLFNBQVQsRUFBb0I7QUFDckNDLFlBQVEsSUFBUixFQUFjRCxTQUFkLEVBQXlCSCxPQUF6QjtBQUNELEdBRmtCLENBRWpCSyxJQUZpQixDQUVaLElBRlksQ0FBbkI7QUFHRDs7QUFFRCxTQUFTQyxHQUFULENBQWFQLFVBQWIsRUFBeUJDLE9BQXpCLEVBQWtDO0FBQ2hDRCxl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Y3QnO1xuXG5mdW5jdGlvbiBvbihldmVudFR5cGVzLCBoYW5kbGVyKSB7XG4gIGV2ZW50VHlwZXMgPSBldmVudFR5cGVzLnNwbGl0KCcgJyk7IC8vL1xuXG4gIGV2ZW50VHlwZXMuZm9yRWFjaChmdW5jdGlvbihldmVudFR5cGUpIHtcbiAgICBvbkV2ZW50KHRoaXMsIGV2ZW50VHlwZSwgaGFuZGxlcik7XG4gIH0uYmluZCh0aGlzKSk7XG59XG5cbmZ1bmN0aW9uIG9mZihldmVudFR5cGVzLCBoYW5kbGVyKSB7XG4gIGV2ZW50VHlwZXMgPSBldmVudFR5cGVzLnNwbGl0KCcgJyk7IC8vL1xuXG4gIGV2ZW50VHlwZXMuZm9yRWFjaChmdW5jdGlvbihldmVudFR5cGUpIHtcbiAgICBvZmZFdmVudCh0aGlzLCBldmVudFR5cGUsIGhhbmRsZXIpO1xuICB9LmJpbmQodGhpcykpO1xufVxuXG5jb25zdCBldmVudE1peGluID0ge1xuICBvbjogb24sXG4gIG9mZjogb2ZmXG59O1xuXG5tb2R1bGUuZXhwb3J0cyA9IGV2ZW50TWl4aW47XG5cbmZ1bmN0aW9uIG9uRXZlbnQoZWxlbWVudCwgZXZlbnRUeXBlLCBoYW5kbGVyKSB7XG4gIGlmIChlbGVtZW50LmV2ZW50T2JqZWN0TWFwID09PSB1bmRlZmluZWQpIHtcbiAgICBlbGVtZW50LmV2ZW50T2JqZWN0TWFwID0ge307XG4gIH1cblxuICBsZXQgZXZlbnRPYmplY3QgPSBlbGVtZW50LmV2ZW50T2JqZWN0TWFwW2V2ZW50VHlwZV07XG5cbiAgaWYgKCFldmVudE9iamVjdCkge1xuICAgIGV2ZW50T2JqZWN0ID0gY3JlYXRlRXZlbnRPYmplY3QoKTtcblxuICAgIGVsZW1lbnQuZXZlbnRPYmplY3RNYXBbZXZlbnRUeXBlXSA9IGV2ZW50T2JqZWN0O1xuICB9XG5cbiAgZXZlbnRPYmplY3QuYWRkSGFuZGxlcihlbGVtZW50LCBldmVudFR5cGUsIGhhbmRsZXIpO1xufVxuXG5mdW5jdGlvbiBvZmZFdmVudChlbGVtZW50LCBldmVudFR5cGUsIGhhbmRsZXIpIHtcbiAgY29uc3QgZXZlbnRPYmplY3QgPSBlbGVtZW50LmV2ZW50T2JqZWN0TWFwW2V2ZW50VHlwZV0sXG4gICAgICAgIG5vbmVSZW1haW5pbmcgPSBldmVudE9iamVjdC5yZW1vdmVIYW5kbGVyKGVsZW1lbnQsIGV2ZW50VHlwZSwgaGFuZGxlcik7XG5cbiAgaWYgKG5vbmVSZW1haW5pbmcpIHtcbiAgICBkZWxldGUgZWxlbWVudC5ldmVudE9iamVjdE1hcFtldmVudFR5cGVdO1xuICB9XG5cbiAgY29uc3QgZXZlbnRUeXBlcyA9IE9iamVjdC5rZXlzKGVsZW1lbnQuZXZlbnRPYmplY3RNYXApO1xuXG4gIGlmIChldmVudFR5cGVzLmxlbmd0aCA9PT0gMCkge1xuICAgIGRlbGV0ZSBlbGVtZW50LmV2ZW50T2JqZWN0TWFwO1xuICB9XG59XG5cbmZ1bmN0aW9uIGNyZWF0ZUV2ZW50T2JqZWN0KCkge1xuICBjb25zdCBldmVudExpc3RlbmVycyA9IFtdO1xuXG4gIGZ1bmN0aW9uIGFkZEhhbmRsZXIoZWxlbWVudCwgZXZlbnRUeXBlLCBoYW5kbGVyKSB7XG4gICAgY29uc3QgdGFyZ2V0RWxlbWVudCA9IGVsZW1lbnQsICAvLy9cbiAgICAgICAgICBldmVudExpc3RlbmVyID0gY3JlYXRlRXZlbnRMaXN0ZW5lcihoYW5kbGVyLCB0YXJnZXRFbGVtZW50KTtcblxuICAgIGVsZW1lbnQuZG9tRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKGV2ZW50VHlwZSwgZXZlbnRMaXN0ZW5lcik7XG5cbiAgICBldmVudExpc3RlbmVycy5wdXNoKGV2ZW50TGlzdGVuZXIpO1xuICB9XG5cbiAgZnVuY3Rpb24gcmVtb3ZlSGFuZGxlcihlbGVtZW50LCBldmVudFR5cGUsIGhhbmRsZXIgPSBudWxsKSB7XG4gICAgaWYgKGhhbmRsZXIgPT09IG51bGwpIHtcbiAgICAgIGV2ZW50TGlzdGVuZXJzLmZvckVhY2goZnVuY3Rpb24oZXZlbnRMaXN0ZW5lcikge1xuICAgICAgICBlbGVtZW50LmRvbUVsZW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcihldmVudFR5cGUsIGV2ZW50TGlzdGVuZXIpO1xuICAgICAgfSk7XG5cbiAgICAgIGNvbnN0IHN0YXJ0ID0gMDtcblxuICAgICAgZXZlbnRMaXN0ZW5lcnMuc3BsaWNlKHN0YXJ0KTtcbiAgICB9IGVsc2Uge1xuICAgICAgY29uc3QgaW5kZXggPSBpbmRleE9mRXZlbnRMaXN0ZW5lcihldmVudExpc3RlbmVycywgaGFuZGxlciksXG4gICAgICAgICAgICBldmVudExpc3RlbmVyID0gZXZlbnRMaXN0ZW5lcnNbaW5kZXhdO1xuXG4gICAgICBlbGVtZW50LmRvbUVsZW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcihldmVudFR5cGUsIGV2ZW50TGlzdGVuZXIpO1xuXG4gICAgICBjb25zdCBzdGFydCA9IGluZGV4LCAgLy8vXG4gICAgICAgICAgICBkZWxldGVDb3VudCA9IDE7XG5cbiAgICAgIGV2ZW50TGlzdGVuZXJzLnNwbGljZShzdGFydCwgZGVsZXRlQ291bnQpO1xuICAgIH1cblxuICAgIGNvbnN0IG5vbmVSZW1haW5pbmcgPSAoZXZlbnRMaXN0ZW5lcnMubGVuZ3RoID09PSAwKTsgIC8vL1xuXG4gICAgcmV0dXJuIG5vbmVSZW1haW5pbmc7XG4gIH1cblxuICByZXR1cm4ge1xuICAgIGFkZEhhbmRsZXI6IGFkZEhhbmRsZXIsXG4gICAgcmVtb3ZlSGFuZGxlcjogcmVtb3ZlSGFuZGxlclxuICB9O1xufVxuXG5mdW5jdGlvbiBpbmRleE9mRXZlbnRMaXN0ZW5lcihldmVudExpc3RlbmVycywgaGFuZGxlcikge1xuICBsZXQgZm91bmRJbmRleCA9IHVuZGVmaW5lZDsgLy8vXG5cbiAgZXZlbnRMaXN0ZW5lcnMuZm9yRWFjaChmdW5jdGlvbihldmVudExpc3RlbmVyLCBpbmRleCkge1xuICAgIGlmIChldmVudExpc3RlbmVyLmhhbmRsZXIgPT09IGhhbmRsZXIpIHtcbiAgICAgIGZvdW5kSW5kZXggPSBpbmRleDtcbiAgICB9XG4gIH0pO1xuXG4gIGNvbnN0IGluZGV4ID0gZm91bmRJbmRleDsgLy8vXG5cbiAgcmV0dXJuIGluZGV4O1xufVxuXG5mdW5jdGlvbiBjcmVhdGVFdmVudExpc3RlbmVyKGhhbmRsZXIsIHRhcmdldEVsZW1lbnQpIHtcbiAgY29uc3QgZXZlbnRMaXN0ZW5lciA9IGZ1bmN0aW9uKGV2ZW50KSB7XG4gICAgY29uc3QgcHJldmVudERlZmF1bHQgPSAoaGFuZGxlci5pbnRlcm1lZGlhdGVIYW5kbGVyICE9PSB1bmRlZmluZWQpID9cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGhhbmRsZXIuaW50ZXJtZWRpYXRlSGFuZGxlcihoYW5kbGVyLCBldmVudCwgdGFyZ2V0RWxlbWVudCkgOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBoYW5kbGVyKGV2ZW50LCB0YXJnZXRFbGVtZW50KTtcblxuICAgIGlmIChwcmV2ZW50RGVmYXVsdCA9PT0gdHJ1ZSkge1xuICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcbiAgICB9XG5cbiAgICBldmVudC5zdG9wUHJvcGFnYXRpb24oKTtcbiAgfTtcblxuICBldmVudExpc3RlbmVyLmhhbmRsZXIgPSBoYW5kbGVyOyAgLy8vXG5cbiAgcmV0dXJuIGV2ZW50TGlzdGVuZXI7XG59XG4iXX0=